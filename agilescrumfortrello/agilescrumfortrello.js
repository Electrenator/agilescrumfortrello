var AST=AST||{};!function(r){"use strict";$(r).ready(function(){AST=function(r){var n="Agile SCRUM for Trello boards",c="1.4.3",i=/\([0-9\.]{1,6}\/[0-9\.]{1,6}\)/,o=/\([0-9\.]{1,6}\//,l=/\/[0-9\.]{1,6}\)/,d=/\([0-9\.]{1,5}\)/,u=/[0-9\.]+/,f=/\[([\u3400-\uFAFF\u3040-\u30ff\uff65-\uffdca-zA-ZáãàâäéèẽêëíìĩîïóòõôöúùũûüçÁÃÀÂÄÉÈẼÊËÍÌĨÎÏÓÒÕÔÖÚÙŨÛÜÇ0-9 \_\-\.\#]*)\]/g,p=/>\*{3} .+ \*{3}$/i,h=/c\/([^\/]+)\/.+/g,g=1,b=!1,v=0,T="",w=!1,M=5e3,A=0,C=!1,F=0,H=0,S=!1,k=0,x=0,U=!1,_=0,j=0,z=!1,I=!1;r.init=function(){console.info(n+" v"+c+" started"),D(),R()};var D=function(){var r=null,n=null;R(),$(".window-wrapper").bind("DOMSubtreeModified",function(){window.location.href.match(h)&&!n?(r=h.exec(window.location.href)[1],h.lastIndex=0,n=!0):!window.location.href.match(h)&&n&&(n=!1,R())}),w=setInterval(function(){O()},M)},O=function(){var r=$("#board").html().length;A!==r&&(A=r,R())},R=function(){b=$("body").css("background-color")&&!$("body").hasClass("body-custom-board-background")?$("body").css("background-color"):"rgb(55, 158, 90)",Z(),$("#board").find(".list-cards").each(function(){C=$(this),C.find(".list-card").each(function(){return U=$(this),q(U)?-2:($(U).find(".list-card-title").html().match(/<small /g)?(z=U.data("original"),$(U).find(".list-card-title").html(z)):(z=$(U).find(".list-card-title").html(),U.data("original",z)),B(z)?(x>0&&E(),S=U,S[0].innerHTML=S[0].innerHTML.replace(/( ?\*\*\* ?)/g,""),S.addClass("scrum-card-header")):z.match(i)?(I=z.match(i)[0],_=G(I.match(o)[0]),j=G(I.match(l)[0])):z.match(d)&&(j=G(z.match(d)[0])),T=_==j?" perfect":_>j?" overrun":"",U[0].innerHTML=U[0].innerHTML.replace(d,K),U[0].innerHTML=U[0].innerHTML.replace(i,K),U[0].innerHTML=U[0].innerHTML.replace(f,J),j>0&&(v=_/j*100,U.prepend('<div class="scrum-card-progress'+T+'" style="background-color:'+b+";width:"+(100>=v?v:100)+'%"></div>'),$(U[0]).css("font-size",(8>j?90+5*j:130)+"%").css("line-height","1.2em")),F+=_,H+=j,S&&(k+=_,x+=j),U=!1,z=I="",void(j=_=0))}),x>0&&E(),C.parent().prepend('<small class="scrum-list-total'+T+'"><span class="scrum-light">'+F.toFixed(g)+"/</span>"+H.toFixed(g)+"</small>"),H>0&&(v=F/H*100,C.parent(".list").prepend('<div class="scrum-list-progress"  style="background-color:'+b+";width:"+(100>=v?v:100)+'%"></div>')),C=!1,F=H=0})},Z=function(){$(".scrum-list-total,.scrum-list-progress,.scrum-card-progress").remove()},q=function(){return U.hasClass("js-composer")},B=function(r){return r.match(p)},E=function(){$(S.find(".list-card-title")[0]).prepend('<small class="scrum-card-points'+(k>x?" overrun":"")+'"><span class="scrum-light">'+k.toFixed(g)+"/</span>"+x.toFixed(g)+"</small>"),k=x=0},G=function(r){return parseFloat(r.match(u)[0])},J=function(r){var n=r.split("__"),c=P(n[0]);return"undefined"!=typeof n[1]&&(c=n[1]),'<small class="scrum-card-project" style="background:'+c.replace(/\[|\]/g,"")+'">'+n[0].replace(/\[|\]/g,"").toUpperCase()+"</small>"},K=function(r){return'<small class="scrum-card-points'+T+'">'+r.replace(/\(|\)/g,"").toUpperCase()+"</small>"},P=function(s){var r=0,n=0,c=s.length;for(s=s.toLowerCase();c>n;n++)r+=900*s.charAt(n).charCodeAt();return"hsla("+r%256+",50%,40%,1)"};return r}(AST||{}),AST.init()})}(document);