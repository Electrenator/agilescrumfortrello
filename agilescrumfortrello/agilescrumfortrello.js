var AST=AST||{};!function(r){"use strict";$(r).ready(function(){AST=function(r){var t="Agile SCRUM for Trello boards",s="1.4.3",n=/\([0-9\.]{1,6}\/[0-9\.]{1,6}\)/,a=/\([0-9\.]{1,6}\//,c=/\/[0-9\.]{1,6}\)/,e=/\([0-9\.]{1,5}\)/,i=/[0-9\.]+/,l=/\[([a-zA-Z0-9 \_\-\.\#]*)\]/g,o=/>\*{3} .+ \*{3}$/i,d=1,u=!1,m="",p=!1,h=5e3,f=0,g=!1,b=0,v=0,T=!1,A=0,L=0,M=!1,y=0,C=0,H=!1,k=!1;r.init=function(){console.info(t+" v"+s+" started"),S(),x()};var S=function(){x(),p=setInterval(function(){F()},h)},F=function(){var r=$("#board").html().length;f!==r&&(f=r,x())},x=function(){u=$("body").css("background-color")&&!$("body").hasClass("body-custom-board-background")?$("body").css("background-color"):"rgb(55, 158, 90)",w(),$("#board").find(".list-cards").each(function(){g=$(this),g.find(".list-card").each(function(){return M=$(this),U(M)?-2:($(M).find(".list-card-title").html().match(/<small /g)?(H=M.data("original"),$(M).find(".list-card-title").html(H)):(H=$(M).find(".list-card-title").html(),M.data("original",H)),j(H)?(L>0&&z(),T=M,T[0].innerHTML=T[0].innerHTML.replace(/( ?\*\*\* ?)/g,""),T.addClass("scrum-card-header")):H.match(n)?(k=H.match(n)[0],y=I(k.match(a)[0]),C=I(k.match(c)[0])):H.match(e)&&(C=I(H.match(e)[0])),m=y==C?" perfect":y>C?" overrun":"",M[0].innerHTML=M[0].innerHTML.replace(e,Z),M[0].innerHTML=M[0].innerHTML.replace(n,Z),M[0].innerHTML=M[0].innerHTML.replace(l,R),C>0&&(M.prepend('<div class="scrum-card-progress'+m+'" style="background-color:'+u+";width:"+y/C*100+'%"></div>'),$(M[0]).css("font-size",(8>C?90+5*C:130)+"%").css("line-height","1.2em")),b+=y,v+=C,T&&(A+=y,L+=C),M=!1,H=k="",void(C=y=0))}),L>0&&z(),g.parent().prepend('<small class="scrum-list-total'+m+'"><span class="scrum-light">'+b.toFixed(d)+"/</span>"+v.toFixed(d)+"</small>"),v>0&&g.parent(".list").prepend('<div class="scrum-list-progress"  style="background-color:'+u+";width:"+b/v*100+'%"></div>'),g=!1,b=v=0})},w=function(){$(".scrum-list-total,.scrum-list-progress,.scrum-card-progress").remove()},U=function(){return M.hasClass("js-composer")},j=function(r){return r.match(o)},z=function(){$(T.find(".list-card-title")[0]).prepend('<small class="scrum-card-points'+(A>L?" overrun":"")+'"><span class="scrum-light">'+A.toFixed(d)+"/</span>"+L.toFixed(d)+"</small>"),A=L=0},I=function(r){return parseFloat(r.match(i)[0])},R=function(r){return'<small class="scrum-card-project" style="background:'+_(r)+'">'+r.replace(/\[|\]/g,"").toUpperCase()+"</small>"},Z=function(r){return'<small class="scrum-card-points'+m+'">'+r.replace(/\(|\)/g,"").toUpperCase()+"</small>"},_=function(r){var t=0,s=0,n=r.length;for(r=r.toLowerCase();n>s;s++)t+=900*r.charAt(s).charCodeAt();return"hsla("+t%256+",50%,60%,1)"};return r}(AST||{}),AST.init()})}(document);